# 免責
このリポジトリは公開されていますが、これはAIによって書かれており、私用の範囲を超えてメンテするつもりはありません。

# Slack Message Correction Extension

Slackメッセージ送信前にAI校正を行うChrome拡張機能です。Claude APIを使用してネイティブレベルの自然な校正を提供します。

## 主な機能

### 🤖 AI校正機能
- **Claude API連携**: 高精度な誤字・表現チェック
- **ネイティブレベル校正**: 自然な英語表現への修正提案
- **重要度スコア**: 修正の必要性を数値で表示（30%未満の軽微な修正は非表示）

### ✨ インタラクティブダイアログ
- **リアルタイム差分表示**: 修正箇所をハイライト表示
- **手動編集機能**: ユーザーが自由に文章を編集可能
- **再校正機能**: 編集後のテキストを再度AI校正
- **3つの送信オプション**:
  - 修正版を送信（完全一致時のみ有効）
  - このまま送信（現在編集中のテキスト）
  - ダイアログを閉じる

### ⌨️ 送信方法対応
- **送信ボタンクリック**: 全ての送信ボタンに対応
- **キーボードショートカット**: Ctrl+Enter / Cmd+Enter
- **動的要素対応**: MutationObserverで新しく追加される要素も監視

### 🎨 ユーザビリティ
- **ローディングインジケータ**: AI校正中の視覚フィードバック
- **問題分類表示**: 誤字・自然度など問題タイプ別に分類
- **末尾スペース無視**: 細かな差異を自動で処理

## セットアップ

### 1. 拡張機能のインストール
```bash
# 依存関係のインストール
npm install

# ビルド
npm run build
```

### 2. Chrome拡張機能として読み込み
1. Chromeで `chrome://extensions/` を開く
2. 「デベロッパーモード」を有効にする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. **`dist`フォルダ**を選択（ビルド後の出力フォルダ）

### 3. Claude API設定
1. 拡張機能のオプションページでClaude APIキーを設定
2. [Anthropic Console](https://console.anthropic.com/)でAPIキーを取得

## 使用方法

### 基本的な使い方
1. Slack Web版（*.slack.com）でメッセージを入力
2. 送信ボタンをクリックまたはCtrl+Enter
3. AI校正が実行され、問題が検出された場合ダイアログが表示
4. 3つのオプションから選択：
   - **修正版を送信**: AIの提案通りに修正（完全一致時のみ）
   - **このまま送信**: 現在編集中のテキストをそのまま送信
   - **再校正**: 編集後のテキストを再度AI校正

### 高度な機能
- **手動編集**: ダイアログ内でテキストを自由に編集
- **差分確認**: 修正箇所がリアルタイムでハイライト表示
- **重要度フィルタ**: 重要度30%未満の修正は自動で除外

## 技術仕様

### アーキテクチャ
- **TypeScript**: 型安全性を確保
- **Vite**: モダンなビルドツール
- **Chrome Extensions Manifest V3**: 最新の拡張機能仕様

### AI校正エンジン
- **モデル**: Claude Haiku 4.5
- **API**: Anthropic Claude API
- **校正観点**:
  - 誤字脱字の修正 (type: "typo")
  - ネイティブな言い回し (type: "nativeness")
- **フォールバック**: APIエラー時はローカルパターンマッチ

### 設定項目
- **校正しきい値**: デフォルト30% (`correctionThreshold`)
- **APIタイムアウト**: 自動設定
- **重要度フィルタ**: 30%未満は非表示

## 開発

### ビルドコマンド
```bash
# 開発ビルド（ウォッチモード）
npm run dev

# プロダクションビルド
npm run build
```

### ファイル構成
```
├── src/
│   ├── content.ts      # メインロジック（TypeScript）
│   ├── background.ts   # Claude API連携（TypeScript）
│   ├── options.js      # 設定ページロジック
│   ├── manifest.json   # 拡張機能設定
│   ├── options.html    # 設定ページ
│   └── styles.css      # UIスタイル
├── dist/              # ビルド出力（Chrome拡張機能として読み込む）
├── tsconfig.json      # TypeScript設定
├── vite.config.js     # ビルド設定
└── package.json       # 依存関係
```

## トラブルシューティング

### よくある問題
1. **校正が実行されない**: Claude APIキーが正しく設定されているか確認
2. **送信ボタンが反応しない**: ページをリロードして拡張機能を再初期化
3. **ダイアログが表示されない**: 校正スコアが30%未満の場合は表示されません

### デバッグ
- コンソールで`🔧`マークのログを確認
- `chrome://extensions/`で拡張機能のエラーを確認
